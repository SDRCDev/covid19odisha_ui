<div class="row">
  <div class="col-md-12">
    <nav>
      <div class="nav nav-tabs nav-fill" id="nav-tab" role="tablist">
        <a class="nav-item nav-link active" id="nav-profile-tab" (click)="q=1" data-toggle="tab" href="#nav-profile" role="tab" aria-controls="nav-profile"
          aria-selected="true">Task Details</a>
        <a class="nav-item nav-link" id="nav-home-tab" (click)="s=1" data-toggle="tab" href="#nav-home" role="tab" aria-controls="nav-home"
          aria-selected="false">Organization Details</a>
      </div>
    </nav>
  </div>
  <div class="tab-content col-md-12" id="nav-tabContent">
    <!-- Content section starts here -->
    <div class="tab-pane fade" id="nav-home" role="tabpanel" aria-labelledby="nav-home-tab">
      <div class="col-md-12">
        <div>
          <div class="reg-field-container col-md-10 offset-md-1 col-sm-12 col-12">
            <table class="table table-striped" style="width: 100%;border:1px solid #ddd">
              <tbody>
                <!-- Label starts here-->
                <tr>
                  <td class="table-subheading" style="text-align:right;">
                    <div> Organization Name : </div>
                  </td>
                  <td class="table-value" style="text-align:left;">
                    <div> {{taskService.volunteerDetails['organizationName']}}</div>
                  </td>
                </tr>

                <tr>
                  <td class="table-subheading" style="text-align:right;">
                    <div> Organization Type : </div>
                  </td>
                  <td class="table-value" style="text-align:left;">
                    <div>{{regForm.organizationType ? regForm.organizationType : taskService.volunteerDetails['organizationType']
                      || 'NA'}}</div>
                  </td>
                </tr>

                <tr>
                  <td class="table-subheading" style="text-align:right;">
                    <div> Registration Number : </div>
                  </td>
                  <td class="table-value" style="text-align:left;">
                    <div>{{taskService.volunteerDetails['registrationNumber']?taskService.volunteerDetails['registrationNumber']:'NA'}}</div>
                  </td>
                </tr>

                <tr>
                  <td class="table-subheading" style="text-align:right;">
                    <div> Country : </div>
                  </td>
                  <td class="table-value" style="text-align:left;">
                    <div>{{regForm.country ? regForm.country : taskService.volunteerDetails['country'] || 'NA'}}</div>
                  </td>
                </tr>

                <tr>
                  <td class="table-subheading" style="text-align:right;">
                    <div> State : </div>
                  </td>
                  <td class="table-value" style="text-align:left;">
                    <div>{{regForm.state ? regForm.state : taskService.volunteerDetails['state'] || 'NA'}}</div>
                  </td>
                </tr>

                <tr>
                  <td class="table-subheading" style="text-align:right;">
                    <div> District : </div>
                  </td>
                  <td class="table-value" style="text-align:left;">
                    <div>{{regForm.district ? regForm.district : taskService.volunteerDetails['district'] || 'NA'}}</div>
                  </td>
                </tr>
                <tr>
                  <td class="table-subheading" style="text-align:right;">
                    <div> Landmark : </div>
                  </td>
                  <td class="table-value" style="text-align:left;">
                    <div> {{taskService.volunteerDetails['landmark']}}</div>
                  </td>
                </tr>

                <tr>
                  <td class="table-subheading" style="text-align:right;">
                    <div> Address : </div>
                  </td>
                  <td class="table-value" style="text-align:left;">
                    <div> {{taskService.volunteerDetails['completeAddress']}}</div>
                  </td>
                </tr>

                <tr>
                  <td class="table-subheading" style="text-align:right;">
                    <div> Contact Person Name : </div>
                  </td>
                  <td class="table-value" style="text-align:left;">
                    <div> {{taskService.volunteerDetails['contactPersonName']}}</div>
                  </td>
                </tr>
                <tr>
                  <td class="table-subheading" style="text-align:right;">
                    <div> Contact Person Email : </div>
                  </td>
                  <td class="table-value" style="text-align:left;">
                    <div> {{taskService.volunteerDetails['contactPersonEmail']}}</div>
                  </td>
                </tr>

                <tr>
                  <td class="table-subheading" style="text-align:right;">
                    <div> Contact Person Mobile Number : </div>
                  </td>
                  <td class="table-value" style="text-align:left;">
                    <div> {{taskService.volunteerDetails['mobile']}}</div>
                  </td>
                </tr>

                <tr>
                  <td class="table-subheading" style="text-align:right;">
                    <div> Service Offered : </div>
                  </td>
                  <td class="table-value" style="text-align:left;">
                    <div>{{regForm.serviceType ? regForm.serviceType : taskService.volunteerDetails['serviceType'] || 'NA'}}</div>
                  </td>
                </tr>

                <tr>
                  <td class="table-subheading" style="text-align:right;">
                    <div> Details of the services/product offered : </div>
                  </td>
                  <td class="table-value" style="text-align:left;">
                    <div> {{taskService.volunteerDetails['serviceDetails']? taskService.volunteerDetails['serviceDetails'] :'NA'}}</div>
                  </td>
                </tr>

                <tr>
                  <td class="table-subheading" style="text-align:right;">
                    <div> Preferred communication method : </div>
                  </td>
                  <td class="table-value" style="text-align:left;">
                    <div>{{regForm.preferredCommunicationMethod ? regForm.preferredCommunicationMethod : taskService.volunteerDetails['preferredCommunicationMethod']
                      || 'NA'}}</div>
                  </td>
                </tr>

                <tr>
                  <td class="table-subheading" style="text-align:right;">
                    <div> Area of Service : </div>
                  </td>
                  <td class="table-value" style="text-align:left;">
                    <div>{{regForm.areaOfService ? regForm.areaOfService : taskService.volunteerDetails['areaOfService'] || 'NA'}}</div>
                  </td>
                </tr>

                <tr>
                  <td class="table-subheading" style="text-align:right;">
                    <div> Preffered State : </div>
                  </td>
                  <td class="table-value" style="text-align:left;">
                    <!-- {{regForm.preferredState |json}} -->
                    <div *ngFor="let col of regForm.preferredState">
                      {{col.areaName ? col.areaName : taskService.volunteerDetails['preferredState']}}
                    </div>
                  </td>
                </tr>

                <tr>
                  <td class="table-subheading" style="text-align:right;">
                    <div> Preffered District : </div>
                  </td>
                  <td class="table-value" style="text-align:left;">
                    <div *ngIf="this.taskService.volunteerDetails['areaOfService'] !=106">
                      <!-- {{regForm.preferredDistrict |json}} -->
                      <div *ngFor="let col of regForm.preferredDistrict">
                        {{col.areaName ? col.areaName : taskService.volunteerDetails['preferredDistrict']}}
                      </div>
                    </div>

                    <div *ngIf="this.taskService.volunteerDetails['areaOfService'] ==106">
                      <div *ngFor="let col of regForm.preferredDistrict; let i=index" style="display : inline-flex;">
                        <div *ngFor="let val of col">
                          {{val.areaName ? val.areaName + ', ': taskService.volunteerDetails['preferredDistrict']}}
                        </div>
                      </div>
                    </div>
                    <div *ngIf="(taskService.volunteerDetails['preferredDistrict']== null ||  taskService.volunteerDetails['preferredDistrict']== [])">
                      NA
                    </div>
                  </td>
                </tr>

                <tr>
                  <td class="table-subheading" style="text-align:right;">
                    <div> Preferred Block/City : </div>
                  </td>
                  <td class="table-value" style="text-align:left;">
                    <div *ngIf="this.taskService.volunteerDetails['areaOfService']!=107">
                      <div *ngFor="let col of regForm.preferredBlock">
                        {{col.areaName ? col.areaName : taskService.volunteerDetails['preferredBlock']?taskService.volunteerDetails['preferredBlock']:'NA'}}
                      </div>
                    </div>
                    <div *ngIf="this.taskService.volunteerDetails['areaOfService'] ==107">
                      <div *ngFor="let col of regForm.preferredBlock; let i=index" style="display : inline-flex;">
                        <div *ngFor="let val of col">
                          {{val.areaName ? val.areaName + ', ': taskService.volunteerDetails['preferredBlock']}}
                        </div>
                      </div>
                    </div>
                    <div *ngIf="(taskService.volunteerDetails['preferredBlock']== null ||  taskService.volunteerDetails['preferredBlock']== [])">
                      NA
                    </div>
                  </td>
                </tr>

              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
    <!-- Content sec ends here -->

    <!-- Volunteer form starts here -->
    <div class="tab-pane fade show active" id="nav-profile" role="tabpanel" aria-labelledby="nav-profile-tab">
      <div class="co-md-12">
        <div class="row v-details">
          <div class="col-md-4">
            <span style="font-weight: 500">{{app.langSelection == 1? 'Organization Name' : 'ଅନୁଷ୍ଠାନ ର ନାମ'}} : </span>
            <span>{{taskService.volunteerDetails['organizationName']}}</span>
          </div>
          <div class="col-md-6">
            <span style="font-weight: 500">{{app.langSelection == 1? 'Contact No.' : 'ଯୋଗାଯୋଗ ନମ୍ବର'}} : </span>
            <span>{{taskService.volunteerDetails['mobile']}}</span>
          </div>
        </div>
        <h5 class="assign">{{app.langSelection == 1? 'Assign Task' : 'କାର୍ଯ୍ୟ ସଂଲଗ୍ନ କରନ୍ତୁ'}}</h5>
        <div class="col-md-9 offset-md-2">
          <form class="all-fields row" #f="ngForm" (submit)="f.valid ?addTask(f):''">
            <div class="selection-fields col-md-12">
              <mat-form-field class="user-mangt">
                <mat-select name="prefactivity" required [placeholder]="app.langSelection == 1 ? 'Activity Type':'କାର୍ଯ୍ୟ ର ପ୍ରକାର'" [(ngModel)]="taskType" required>
                  <mat-option *ngFor="let opt of serviceTypeOffered" [value]="opt">
                    {{opt.name}}</mat-option>
                </mat-select>
                <mat-error class="padding-bottom">
                  {{f.controls['prefactivity']?.errors?.required ? 'Please select activity type': ''}}
                </mat-error>
              </mat-form-field>
            </div>

            <div class="selection-fields col-md-12">             
              <mat-form-field class="user-mangt">
                <textarea matInput required name="assignActivity" [placeholder]="app.langSelection == 1 ? 'Activity Details':  'କାର୍ଯ୍ୟର ସବିଶେଷ ବିବରଣୀ'" row="5" col="4" [pattern]='spaceRegex' [(ngModel)]="taskDetails"
                  maxlength="2000" required></textarea>
                <mat-error class="padding-bottom">
                  <!-- pattern="^[^\s].+$" -->
                  {{f.controls['assignActivity']?.errors?.pattern ? 'Spaces are not allowed at begining':'Please enter activity details'}}
                </mat-error>
              </mat-form-field>
            </div>

            <div class="selection-fields col-md-6">
              <mat-form-field class="user-mangt">
                <input matInput name="cName" [(ngModel)]="contactPersonName" [placeholder]="app.langSelection == 1 ? 'Coordinator Name':  'ସଂଯୋଜକଙ୍କ ନାମ'" required>
                <mat-error class="padding-bottom ">
                  {{f.controls['cName']?.errors?.pattern ? 'pattern':'Please provide coordinator name'}}
                </mat-error>
              </mat-form-field>
            </div>

            <div class="selection-fields col-md-6">
              <mat-form-field class="user-mangt">
                <input matInput name="cmobile" onlyNumber [pattern]='mobRegex' [(ngModel)]="contactPersonMob" [placeholder]="app.langSelection == 1 ? 'Coordinator Mobile No.':  'ସଂଯୋଜକଙ୍କ ମୋବାଇଲ୍ ନମ୍ବର'" required>
                <mat-error class="padding-bottom ">
                  {{f.controls['cmobile']?.errors?.pattern ? 'Mobile no should be 10 digit':'Please provide coordinator mobile number'}}
                </mat-error>
              </mat-form-field>
            </div>
            <div class="form-group col-md-12 text-center">
              <button class="btn btn-default proceed-btn user-submit" type="submit">{{app.langSelection == 1? 'Assign Task' : 'କାର୍ଯ୍ୟ ସଂଲଗ୍ନ କରନ୍ତୁ'}}</button>
            </div>
          </form>
        </div>
      </div>

      <div class="col-md-12">
        <h5 style="position: absolute;border-bottom:none;margin-top:10px;">{{app.langSelection == 1? 'Task List' : 'କାର୍ଯ୍ୟ  ତାଲିକା'}}</h5>
        <div class="table-btn search">
          <div class="col-md-3 col-sm-6 col-6 form-group">
            <input class="form-control" type="text" id="myInput" [(ngModel)]="searchFilter" placeholder="Search" maxlength="100" />
            <span *ngIf="searchFilter" class="search-close" (click)="clearSearchText();">
            </span>
          </div>
        </div>
        <div class="table-responsive">
          <table class="table table-striped table-bordered">
            <thead class="user-table-header" style="border-bottom: 5px solid #fff;">
              <tr>
                <th class="user-table-column" *ngFor="let col of taskService.taskTableColumn; let colms=index">
                    {{app.langSelection == 1 ? col.split("#")[0] : col.split("#")[1]}}
                </th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let rowDetails of taskService.taskTableData | searchText: searchFilter | paginate: {itemsPerPage: itemsPerPage, currentPage: p}; let i = index;">
                <td *ngFor="let col of taskService.taskTableColumn">
                  <div *ngIf="rowDetails">{{rowDetails[col.split("#")[0]]}}</div>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
        <div class="col-md-12 pagination-margin" *ngIf="(taskService.taskTableData && taskService.taskTableData.length && (taskService.taskTableData | searchText: searchFilter).length)">
          <pagination-controls (pageChange)="p = $event;" class="pagination"></pagination-controls>
        </div>
        <div *ngIf="(taskService.taskTableData && !taskService.taskTableData.length) || (taskService.taskTableData && taskService.taskTableData.length && (taskService.taskTableData | searchText: searchFilter).length==0)"
          class="col-md-12 text-center no-data">No Data Found.
        </div>
      </div>
    </div>
    <!-- Volunteer form ends here -->
  </div>


  <!-- Buttons starts here -->
  <div class="col-md-12 text-center">
    <button type="submit" class="btn user-submit" (click)="taskService.destroyModalData()">{{app.langSelection == 1? 'Close' : 'ବନ୍ଦ'}}</button>  
  </div>
  <!-- Buttons ends here -->

  <!-- Content section ends here -->

  <!-- Modal section starts here -->
  <div id="successModal" class="modal fade" data-backdrop="static" data-keyboard="false">
    <div class="modal-dialog modal-confirm">
      <div class="modal-content">
        <div class="modal-body text-center">
          <h4>Success !</h4>
          <p>Task assigned successfully.</p>
          <button class="btn btn-success" data-dismiss="modal">
            <span>OK</span>
          </button>
        </div>
      </div>
    </div>
  </div>
  <!-- Modal section ends here -->